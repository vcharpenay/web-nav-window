<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Web Navigation Window</title>
    <script type="text/javascript" src="navigation.js"></script>
    <script type="text/javascript" src="util.js"></script>
    <script type="text/javascript" src="lib/vis-network.min.js"></script>
    <script type="text/javascript" src="lib/uri.all.min.js"></script>
    <style type="text/css">
        body {
            font-family: monospace;
        }

        .btn {
            padding: 5pt;
            border: 0;
            border-right: 5pt solid hsl(55, 100%, 45%);
            background-color: hsl(55, 100%, 50%);
            font-family: monospace;
        }

        .btn:hover:enabled {
            color: saddlebrown;
        }

        .btn:active:enabled {
            background-color: hsl(55, 100%, 45%);
            border-right: 0;
            border-left: 5pt solid white;
        }

        #explainer {
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            max-width: 420px;
            margin: 10px;
        }

        #explainer-source-node {
            stroke: hsl(55, 100%, 40%);
            fill: hsl(55, 100%, 50%);
        }

        #explainer-other-node {
            stroke: hsl(205, 100%, 40%);
            fill: hsl(205, 100%, 50%);
        }

        #explainer-unknown-node {
            stroke: hsl(55, 20%, 70%);
            fill: hsl(55, 20%, 80%);
        }

        #nav-graph {
            position: absolute;
            top: 0;
            bottom: 50px;
            left: calc(420px + 10px);
            right: 0;
            margin: 10px;
            border: 1px solid lightgray;
        }

        #controls {
            position: absolute;
            bottom: 0;
            left: calc(420px + 10px);
            right: 0;
            margin: 10px;
            height: 40px;
        }

        #overlay {
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: rgba(50, 50, 50, 0.2);
        }

        #modal {
            max-width: 420px;
            margin-top: 100px;
            margin-left: auto;
            margin-right: auto;
            background-color: white;
            padding: 10px;
        }

        #contribute-data {
            resize: none;
        }

        #modal-close-control {
            width: 100%;
            display: inline-block;
            text-align: right;
            text-decoration: underline;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <div id="explainer">
        <h1>Web Navigation Window</h1>
        <h2>What is it for?</h2>
        <p>
            The Web navigation window is a "window" to the way you navigate on
            the Web. It is a browser extension that visualizes your browser
            history as a graph. By following the paths you take on the Web, you
            can see what website you visit the most, where your navigation
            usually starts and how it ends.
        </p>
        <p>
            This extension is also part of a research project on hypermedia
            systems, whose objective is to collect (anonymized) navigation data.
            This navigation data will then be analyzed to compare human browsing
            behaviors with the behavior of autonoumous Web agents ("bots").
        </p>
        <h2>How does it work?</h2>
        <ol>
            <li>
                Select a time period (with the date pickers at the bottom of the
                page) and click "Render".
            </li>
            <li>
                After some processing time, you should see a graph appear in the
                main panel. Zoom in and out (mouse wheel) and drag the graph
                around (left click) to explore.
            </li>
        </ol>
        <p>
            <em>Warning</em>: processing your history over long periods of time
            (one month or longer) may take some time.
        </p>
        <h2>How to interpret the graph?</h2>
        <p>
            This graph is a "navigation graph": every website you've visited is
            displayed as a node and there is an arc for every link you've
            clicked. Some of the arcs start and end on the same node. This
            happens when you navigate to different pages but on the same
            website.
        </p>
        <p>Nodes are colored depending on how navigation started:</p>
        <ul>
            <li>
                Yellow nodes
                (<svg id="explainer-source-node" width="10" height="10">
                    <circle cx="5" cy="5" r="5"/>
                </svg>)
                mark navigation start. They can be your
                browser's home page, a bookmark or a page loaded after typing
                a keyword in the address bar.
            </li>
            <li>
                Blue nodes
                (<svg id="explainer-other-node" width="10" height="10">
                    <circle cx="5" cy="5" r="5"/>
                </svg>)
                are websites reached after browsing, generally by following a
                link.
            </li>
            <li>
                Gray nodes
                (<svg id="explainer-unknown-node" width="10" height="10">
                    <circle cx="5" cy="5" r="5"/>
                </svg>)
                are similar to blue nodes but the origin of navigation is
                unknown. This happens e.g. when you follow a link from another
                application such as your e-mail client or when you open a new
                tab when following a link.
            </li>
        </ul>
        <hr>
        <p>
            <i>
                Any question or suggestion?
                <a href="mailto:victor.charpenay@emse.fr">Contact us</a>!
            </i>
        </p>
    </div>
    <!-- TODO reactive UI: if small screen: graph below explainer -->
    <div id="nav-graph"></div>
    <div id="controls">
        <span>From</span>
        <input id="begin-control" type="date" value="2020-02-01">
        <span>To</span>
        <input id="end-control" type="date" value="2020-02-02">
        <input id="render-control" type="button" value="Render" class="btn">
        <input id="anonymize-control" type="button" value="Anonymize" class="btn">
        <input id="contribute-control" type="button" value="Contribute!" class="btn">
        <span id="render-message" hidden>Rendering...</span>
    </div>
    <div id="overlay" hidden>
        <div id="modal">
            <span id="modal-close-control">Close</span>
            <br>
            <p>
                To contribute, you can share a fragment of your (anonymized)
                browser history.
            </p>
            <ol>
                <li>
                    <p>
                        Copy the raw data below to clipboard. It corresponds to
                        navigation data extracted from your browser over the
                        period March-April 2020.
                    </p>
                    <textarea id="contribute-data" readonly rows="10" cols="40">Loading...</textarea>
                    <input id="modal-copy-control" disabled type="button" value="Copy to clipboard" class="btn">
                    <span id="modal-copy-message" hidden>Copied!</span>
                </li>
                <li>
                    <p>
                        Open a new file in a plain text editor. 
                    </p>
                    <ul>
                        <li>On Windows, use e.g. Notepad</li>
                        <li>On Mac, use e.g. TextEdit</li>
                        <li>On Linux/Ubuntu, use e.g. Gedit</li>
                    </ul>
                </li>
                <li>
                    <p>
                        Paste the raw data in the opened file. Save the file
                        with filename ending with ".json" (e.g. "data.json").
                    </p>
                </li>
                <li>
                    <p>
                        Fill in the data collection form at:
                        <a href="https://portail.emse.fr/limesurvey/index.php/644842/lang-en">
                            https://portail.emse.fr/limesurvey/index.php/644842/lang-en
                        </a>
                    </p>
                </li>
            </ol>
        </div>
    </div>
    <script type="text/javascript" src="network.js"></script>
</body>

</html>